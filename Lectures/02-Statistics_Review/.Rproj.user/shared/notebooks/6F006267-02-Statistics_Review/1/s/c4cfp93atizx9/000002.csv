"0","n <- 50"
"0","df <- tibble("
"0","    x = seq(-4,4, by = 0.01),"
"0","    y = dt(seq(-4,4, by = 0.01), n),"
"0","    y_norm = dnorm(seq(-4,4, by = 0.01))"
"0",")"
"0","crit <- qt(c(.025,.975), n)"
"0","tail_left <- rbind(c(crit[1],0), subset(df, x < crit[1]))"
"0","tail_right <- rbind(c(crit[2],0), subset(df, x > crit[2]), c(3,0))"
"0","ggplot() +"
"0","  scale_x_continuous(limits = c(-4, 4), expand=c(0,0)) +"
"0","  scale_y_continuous(limits = c(0, 0.5), expand=c(0,0), breaks = c(0, 0.5), labels = c(0, 0.5)) +"
"0","  geom_line(data = df, aes(x, y), color = ""#9370DB"", size = 1) +"
"0","  geom_line(data = df, aes(x, y_norm), color = ""#007935"", size = 1) +"
"0","  # geom_polygon(data = tail_left, aes(x=x, y=y), fill = red_pink) +"
"0","  # geom_polygon(data = tail_right, aes(x=x, y=y), fill = red_pink) +"
"0","  # geom_polygon(data = df %>% filter(x <= qt(1 - 0.975, n) & x >= qt(0.975, n)), aes(x, y), fill = red_pink) +"
"0","  geom_vline(xintercept = qt(0.975, n), size = 0.35, linetype = ""dashed"", color = ""#9370DB"") +"
"0","  geom_vline(xintercept = qt(1 - 0.975, n), size = 0.35, linetype = ""dashed"", color = ""#9370DB"") +"
"0","  geom_vline(xintercept = -1.96, size = 0.35, linetype = ""dashed"", color = ""#007935"") +"
"0","  geom_vline(xintercept = 1.96, size = 0.35, linetype = ""dashed"", color = ""#007935"") +"
"0","  theme_simple +"
"0","  xlab("""") + "
"0","  ylab("""") + theme(axis.text.y = element_blank(), axis.line.y = element_blank())"
